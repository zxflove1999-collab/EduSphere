# 智能校园系统用户接口测试

## 1. 认证管理 (Authentication)

### 1.1 用户登录

| 序号 | 测试场景                                 | 输入数据（JSON）                                          | 预期结果                                             | 测试目的                                    | 测试结论                                                 |
| ---- | ---------------------------------------- | --------------------------------------------------------- | ---------------------------------------------------- | ------------------------------------------- | -------------------------------------------------------- |
| 4    | username 为空                            | `json { "username": "", "password": "123456" }`           | 响应 `code=0，msg="username为必填项"`                | 验证用户名必填校验。                        | 不通过，之前插入一个学生没有username，这里还是登录成功了 |
| 8    | username 含特殊字符（非学号 / 工号格式） | `json { "username": "2021#001", "password": "123456" }`   | 响应 `code=0，msg="用户名格式错误（应为学号/工号）"` | 验证用户名格式校验（如纯数字 / 特定前缀）。 | 响应：用户名或密码错误，可以修改                         |
| 9    | 账号已被禁用（数据库中状态为禁用）       | `json { "username": "2021001003", "password": "123456" }` | 响应 `code=0，msg="账号已被禁用，请联系管理员"`      | 验证禁用账号的登录控制。                    |                                                          |

## 2.个人中心 (Profile)

### 2.1 获取当前登录用户信息

| 序号 | 测试场景                                        | 请求参数（Header）                                           | 预期结果                                     | 测试目的                    | 测试结果                                                     |
| ---- | ----------------------------------------------- | ------------------------------------------------------------ | -------------------------------------------- | --------------------------- | ------------------------------------------------------------ |
| 5    | 未携带 token（Header 中无 token 参数）          | 无 token 字段                                                | 响应 `code=0，msg="请先登录（token不存在）"` | 验证 token 必填校验。       | 可优化"msg": "系统错误：CharSequence cannot be null or empty." |
| 6    | 携带无效 token（随机字符串）                    | `token: "abc123invalidtoken"`                                | 响应 `code=0，msg="token无效或已过期"`       | 验证无效 token 的拦截处理。 | 可优化："msg": "系统错误：Invalid compact JWT string: Compact JWSs must contain exactly 2 period characters, and compact JWEs must contain exactly 4.  Found: 0", |
| 7    | 携带被篡改的 token（修改有效 token 的部分字符） | `token: "eyJhbGciOiJIUzI1NiJ9.eyJpZCI6MTAwMSwixxxxx...（被篡改的token）"` | 响应 `code=0，msg="token验证失败"`           | 验证 token 防篡改机制。     | 可优化："msg": "系统错误：Unsupported signature algorithm 'KS384'" |

| 序号 | 测试场景                                | 请求参数（Header）                  | 预期结果 | 测试目的 | 测试结论                                                     |
| ---- | --------------------------------------- | ----------------------------------- | -------- | -------- | ------------------------------------------------------------ |
| 11   | 并发请求（同一 token 同时发起多次请求） | 用同一有效 token，同时发起 3 次请求 |          |          | "msg": "系统错误：Compact JWT strings may not contain whitespace.", |

### 2.2 修改当前用户信息&2.3修改当前用户密码

是我没登陆吗，测的都是这样

`{`

​    `"code": 0,`

​    `"msg": "系统错误：CharSequence cannot be null or empty.",`

​    `"data": null`

`}`

## 3. (公共)文件上传

### 3.1 文件上传

发送.pdf 失败：错误：无法请求地址 http://127.0.0.1:8081/upload

不发送文件：{ "code": 0, "msg": "系统错误：Required part 'file' is not present.","data": null}

## 4. 角色管理 (Admin)

### 4.1 角色列表查询

| 序号 | 测试场景                              | 请求参数（QueryString） | 前置条件                                | 预期结果                                                     | 测试目的                           | 测试结论               |
| ---- | ------------------------------------- | ----------------------- | --------------------------------------- | ------------------------------------------------------------ | ---------------------------------- | ---------------------- |
| 7    | page 为无效值（负数 page=-1）         | `page=-1&pageSize=10`   | 管理员已登录                            | 响应 `code≠1，msg` 提示 “页码必须为正整数”；或自动修正为默认 page=1 并返回正确结果 | 验证页码无效时的参数校验           | 不通过，返回了所有角色 |
| 8    | pageSize 为无效值                     | `page=1&pageSize=0`     | 管理员已登录                            | 响应 `code≠1，msg` 提示 “每页数量必须为正整数”；或自动修正为默认 pageSize=10 并返回正确结果 | 验证每页数量无效时的参数校验       | 不通过，返回空         |
| 9    | 未登录状态查询                        | 无参数（或任意参数）    | 未携带有效管理员 token                  | 响应 `code≠1，msg` 提示 “请先登录” 或 “无权限访问”           | 验证登录状态和权限校验             | 不通过，没有验证       |
| 10   | 非管理员角色查询（如学生 / 教师登录） | `page=1&role_name=学生` | 学生 / 教师已登录（携带非管理员 token） | 响应 `code≠1，msg` 提示 “无权限访问”                         | 验证角色权限控制（仅管理员可访问） | 不通过                 |

### 4.2 添加角色

通过

### 4.3 根据ID查询角色

| 序号 | 测试场景                                    | 请求参数（路径参数） | 前置条件                         | 预期结果                                               | 测试目的                         | 测试结论                                                     |
| ---- | ------------------------------------------- | -------------------- | -------------------------------- | ------------------------------------------------------ | -------------------------------- | ------------------------------------------------------------ |
| 4    | 角色 ID 为非数字（如 ID=abc）               | `/admin/roles/abc`   | 管理员已登录                     | 响应`code≠1，msg`提示 “角色 ID 必须为数字” 或 404 错误 | 验证角色 ID 为非数字时的参数校验 | 不通过：响应{"code":0,"msg":"系统错误：Method parameter 'id': Failed to convert value of type 'java.lang.String' to required type 'java.lang.Integer'; For input string: \"ff\"","data":null} |
| 5    | 未登录状态查询存在的角色 ID                 | `/admin/roles/2`     | 未携带有效 token                 | 响应`code≠1，msg`提示 “请先登录”                       | 验证未登录时的权限控制           | 不通过，没有检测token                                        |
| 6    | 非管理员角色查询（如学生登录查询角色 ID=1） | `/admin/roles/1`     | 学生已登录（携带非管理员 token） | 响应`code≠1，msg`提示 “无权限访问”                     | 验证非管理员角色的权限控制       | 同上                                                         |

### 4.4修改角色

这一部分没有改成功的

| 序号 | 测试场景                               | 请求参数（JSON）                                             | 前置条件                                                     | 预期结果                                                     | 测试目的                       | 测试结论                                   |
| ---- | -------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------ | ------------------------------------------ |
| 1    | 修改存在的角色（完整参数）             | `json{"role_id":3,"role_name":"test","role_key":"test","description":"负责管理智能教学系统的管理员"}` | 管理员已登录                                                 | 响应`code=1，msg="success"`；数据库中该角色的 name、key、description 均更新为请求值 | 验证完整参数下修改角色的功能   | 不通过，返回显示角色不存在，但数据库中存在 |
| 2    | 修改角色（仅必填参数，无 description） | `json{"role_id":3,"role_name":"新教学管理员","role_key":"new_teaching_admin"}` | 管理员已登录，系统中存在 role_id=3 的角色                    | 响应`code=1，msg="success"`；数据库中 role_name 和 role_key 更新，description 保持原值或设为空 | 验证缺少非必填参数时的修改功能 | 同上                                       |
| 3    | 修改系统内置角色（is_system=1）        | `json{"role_id":1,"role_name":"新学生角色","role_key":"new_student"}` | 管理员已登录，系统中存在 is_system=1 的角色（如 role_id=1）  | 响应`code≠1，msg`提示 “系统内置角色不允许修改”；数据库字段未更新 | 验证系统内置角色的修改限制     | 同上                                       |
| 5    | 缺少必填参数 role_id                   | `json{"role_name":"测试角色","role_key":"test_role"}`        | 管理员已登录                                                 | 响应`code≠1，msg`提示 “role_id 为必填项”；数据库无变化       | 验证 role_id 的必填性校验      | 不通过，还是显示角色不存在                 |
| 6    | 缺少必填参数 role_name                 | `json{"role_id":3,"role_key":"test_role","description":"测试"}` | 管理员已登录，系统中存在 role_id=3 的角色                    | 响应`code≠1，msg`提示 “角色名称为必填项”；数据库无变化       | 验证 role_name 的必填性校验    |                                            |
| 7    | 缺少必填参数 role_key                  | `json{"role_id":3,"role_name":"测试角色","description":"测试"}` | 管理员已登录，系统中存在 role_id=3 的角色                    | 响应`code≠1，msg`提示 “角色标识为必填项”；数据库无变化       | 验证 role_key 的必填性校验     |                                            |
| 8    | role_name 为空字符串                   | `json{"role_id":3,"role_name":"","role_key":"teaching_admin"}` | 管理员已登录，系统中存在 role_id=3 的角色                    | 响应`code≠1，msg`提示 “角色名称不能为空”；数据库无变化       | 验证角色名称为空的校验         |                                            |
| 9    | role_key 与其他角色重复                | `json{"role_id":3,"role_name":"教学管理员","role_key":"student"}`（假设 “student” 已被其他角色使用） | 管理员已登录，系统中存在 role_id=3 的角色，且存在 role_key=“student” 的角色 | 响应`code≠1，msg`提示 “角色标识已存在”；数据库无变化         | 验证角色标识的唯一性校验       |                                            |
| 10   | 未登录状态修改角色                     | `json{"role_id":3,"role_name":"教学管理员","role_key":"teaching_admin"}` | 未携带有效管理员 token                                       | 响应`code≠1，msg`提示 “请先登录”；数据库无变化               | 验证未登录时的权限控制         |                                            |
| 11   | 非管理员角色修改（如学生登录）         | `json{"role_id":3,"role_name":"教学管理员","role_key":"teaching_admin"}` | 学生已登录（携带非管理员 token）                             | 响应`code≠1，msg`提示 “无权限访问”；数据库无变化             | 验证非管理员的权限控制         |                                            |

### 4.5 删除角色

不输id返回{"code":0,"msg":"系统错误：No static resource admin/roles.","data":null}

## 5. 学生管理 (Admin)

### 5.1学生列表查询



| 序号 | 测试场景                                          | 请求参数（QueryString）     | 前置条件                    | 预期结果                                                     | 测试目的                             | 测试结论                    |
| ---- | ------------------------------------------------- | --------------------------- | --------------------------- | ------------------------------------------------------------ | ------------------------------------ | --------------------------- |
| 9    | 非管理员角色访问（学生 / 教师 token）             | 无参数                      | 学生登录（携带学生 token）  | 响应 `code=0，msg="无权限访问（需管理员角色）"`              | 验证接口权限控制（仅管理员可访问）。 | 接口无token种类需求，可优化 |
| 10   | 未携带 token                                      | 无参数                      | 未登录（Header 中无 token） | 响应 `code=0，msg="请先登录"`                                | 验证 token 必填校验。                | 同上                        |
| 11   | 分页参数为负数（page=-1）                         | `page=-1&pageSize=10`       | 管理员登录                  | 响应 `code=0，msg="page参数必须为正整数"`                    | 验证分页参数合法性校验。             | 不通过，未校验合法性        |
| 12   | 分页参数为 0（pageSize=0）                        | `page=1&pageSize=0`         | 同上                        | 响应 `code=0，msg="pageSize参数必须为正整数（1-100）"`       | 验证每页数量的边界校验。             | 不通过msg"success"          |
| 13   | 状态参数为无效值（status=3，合法值为 1/2）        | `status=3`                  | 同上                        | 响应 `code=0，msg="status参数无效（1=激活，2=禁用）"`        | 验证状态参数枚举值校验。             | 不通过，未校验合法性        |
| 14   | 学号含非数字字符（如`student_id_number=2021abc`） | `student_id_number=2021abc` | 同上                        | 响应 `code=0，msg="学号格式错误（纯数字）"` 或返回空列表（无匹配结果）。 | 验证学号格式筛选的兼容性。           | 不通过，未校验合法性        |

### 5.2添加学生

| 序号 | 测试场景                                  | 输入数据（JSON）                                             | 预期结果                                             | 测试目的                     | 测试结论                                                     |
| ---- | ----------------------------------------- | ------------------------------------------------------------ | ---------------------------------------------------- | ---------------------------- | ------------------------------------------------------------ |
| 5    | username（学号）为空                      | `json { "username": "", "password": "123456", "full_name": "刘同学" }` | 响应 `code!=1，msg="username为必填项"`               | 验证 username 必填校验。     | 不通过，接口返回成功（状态码 200），数据库中新增用户的 username 为 “ ”。 |
| 6    | username 含非数字字符（不符合学号格式）   | `json { "username": "2021abc005", "password": "123456", "full_name": "陈同学" }` | 响应 `code!=1，msg="username必须为纯数字学号"`       | 验证学号格式（纯数字）校验。 | 不通过，接口返回成功（状态码 200），数据库中新增用户的 username 为 “2021abc005 ”。 |
| 8    | full_name 为空                            | `json { "username": "2021001006", "password": "123456", "full_name": "" }` | 响应 `code!=1，msg="full_name为必填项"`              | 验证真实姓名必填校验。       | 不通过，接口返回成功（状态码 200），数据库中新增用户         |
| 9    | gender 为无效值（如 3）                   | `json { "username": "2021001007", "password": "123456", "full_name": "杨同学", "gender": 3 }` | 响应 `code!=1，msg="gender值无效（0/1/2）"`          | 验证性别参数枚举值合法性。   | 不通过，接口返回成功（状态码 200），数据库中新增用户         |
| 10   | email 格式错误（无 @符号）                | `json { "username": "2021001008", "password": "123456", "full_name": "黄同学", "email": "huang.edu.cn" }` | 响应 `code!=1，msg="email格式不正确"`                | 验证邮箱格式校验。           | 不通过，接口返回成功（状态码 200），数据库中新增用户         |
| 11   | phone_number 格式错误（非 11 位数字）     | `json { "username": "2021001009", "password": "123456", "full_name": "周同学", "phone_number": "12345" }` | 响应 `code!=1，msg="手机号码格式不正确（11位数字）"` | 验证手机号格式校验。         | 不通过，接口返回成功（状态码 200），数据库中新增用户         |
| 12   | enrollment_date 格式错误（非 yyyy-MM-dd） | `json { "username": "2021001010", "password": "123456", "full_name": "吴同学", "enrollment_date": "2021/09/01" }` |                                                      | 验证日期格式校验。           | 可优化，响应系统错误                                         |

### 5.3 根据ID查询学生

输入非数字（如：ddd显示系统错误）{"code":0,"msg":"系统错误：Method parameter 'id': Failed to convert value of type 'java.lang.String' to required type 'java.lang.Long'; For input string: \"ddd\"","data":null}

### 5.4修改学生资料

通过

### 5.5 删除学生

| 序号 | 测试场景                                  | 请求参数（路径参数）               | 前置条件                                                     | 预期结果                                                     | 测试目的                     | 测试结论                                                     |
| ---- | ----------------------------------------- | ---------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------------------------- | ------------------------------------------------------------ |
| 1    | 批量删除多个存在的学生 ID（如 1001,1002） | `/admin/students/1001,1002`        | 管理员已登录（携带有效管理员 token），系统中存在 student_id 为 1001、1002 的学生 | 响应`code=1，msg="success"`；数据库中 ID 为 1001、1002 的学生记录被删除 | 验证批量删除存在的学生功能   | 不通过，只能一次查一个                                       |
| 3    | 删除包含不存在的学生 ID                   | `/admin/students/1111111111111111` | 管理员已登录，系统中不存在 1111111111111111                  | 响应`code≠1，msg`提示 “部分学生不存在” 或 “删除失败”         | 验证包含无效 ID 时的删除处理 | 不通过，显示删除成功                                         |
| 4    | 删除的学生 ID 为空（如空字符串）          | `/admin/students/`                 | 管理员已登录                                                 | 响应`code≠1，msg`提示 “学生 ID 不能为空”                     | 验证 ID 为空时的参数校验     | 不通过，{"code":0,"msg":"系统错误：No static resource admin/students.","data":null} |
| 5    | 学生 ID 格式错误（含非数字）              | `/admin/students/bca`              | 管理员已登录                                                 | 响应`code≠1，msg`提示 “学生 ID 格式错误”                     | 验证非数字 ID 的校验         | 不通过：{"code":0,"msg":"系统错误：For input string: \"bca\"","data":null} |
| 8    | 非管理员角色删除（如教师登录）            | `/admin/students/1001`             | 教师已登录（携带非管理员 token）                             | 响应`code≠1，msg`提示 “无权限执行此操作”；数据库无变化       | 验证非管理员的权限控制       | 通过                                                         |

注意验证token

## 6. 教师管理 (Admin)

### 6.1 教师列表查询

还是page会有问题同5.1

### 6.2 添加教师

| 序号 | 测试场景                              | 请求参数（JSON）                                             | 前置条件                        | 预期结果                                                     | 测试目的                | 测试结论                                                     |
| ---- | ------------------------------------- | ------------------------------------------------------------ | ------------------------------- | ------------------------------------------------------------ | ----------------------- | ------------------------------------------------------------ |
| 5    | 缺少必填参数 username                 | `json{"password":"123456","full_name":"张老师"}`             | 管理员已登录                    | 响应`code≠1，msg`提示 “登录账号为必填项”；数据库无新增记录   | 验证 username 的必填性  | 不通过返回：{"code":0,"msg":"系统错误：\r\n### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'username' cannot be null\r\n### The error may exist in file [D:\\Item\\IDEA\\EduSphere-master\\target\\classes\\mapper\\UserMapper.xml]\r\n### The error may involve defaultParameterMap\r\n### The error occurred while setting parameters\r\n### SQL: INSERT INTO t_user (username, password_hash, full_name, email, phone_number, avatar_url, status, token_version)         VALUES (?, ?, ?, ?, ?, ?, ?, ?)\r\n### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'username' cannot be null\n; Column 'username' cannot be null","data":null} |
| 6    | 缺少必填参数 full_name                | `json{"username":"T2025005","password":"123456"}`            | 管理员已登录                    | 响应`code≠1，msg`提示 “教师真实姓名为必填项”；数据库无新增记录 | 验证 full_name 的必填性 | 不通过：{"code":0,"msg":"系统错误：\r\n### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'full_name' cannot be null\r\n### The error may exist in file [D:\\Item\\IDEA\\EduSphere-master\\target\\classes\\mapper\\UserMapper.xml]\r\n### The error may involve defaultParameterMap\r\n### The error occurred while setting parameters\r\n### SQL: INSERT INTO t_user (username, password_hash, full_name, email, phone_number, avatar_url, status, token_version)         VALUES (?, ?, ?, ?, ?, ?, ?, ?)\r\n### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'full_name' cannot be null\n; Column 'full_name' cannot be null","data":null} |
| 7    | email 格式错误（不含 @）              | `json{"username":"T2025006","password":"123456","full_name":"赵老师","email":"zhaoedu.cn"}` | 管理员已登录，username 未被占用 | 响应`code≠1，msg`提示 “邮箱格式错误”；数据库无新增记录       | 验证 email 格式校验     | 不通过，添加成功，没有email格式校验                          |
| 8    | phone_number 格式错误（非 11 位数字） | `json{"username":"T2025007","password":"123456","full_name":"孙老师","phone_number":"1361234"}` | 管理员已登录，username 未被占用 | 响应`code≠1，msg`提示 “手机号码格式错误”；数据库无新增记录   | 验证手机号格式校验      | 不通过，添加成功，没有电话格式校验                           |
| 9    | gender 值不在允许范围（如 3）         | `json{"username":"T2025008","password":"123456","full_name":"周老师","gender":3}` | 管理员已登录，username 未被占用 | 响应`code≠1，msg`提示 “性别值无效（0/1/2）”；数据库无新增记录 | 验证 gender 参数合法性  | 不通过，添加成功                                             |



这个也要注意角色权限

### 6.3 根据ID查询教师

同5.3

### 6.4 修改教师资料

通过

### 6.5 删除教师

| 序号 | 测试场景                                    | 请求参数（路径参数）        | 前置条件                                                   | 预期结果                                                     | 测试目的                     | 测试结论                                                     |
| ---- | ------------------------------------------- | --------------------------- | ---------------------------------------------------------- | ------------------------------------------------------------ | ---------------------------- | ------------------------------------------------------------ |
| 3    | 删除包含不存在的教师 ID（如 2001,9999）     | `/admin/teachers/2001,9999` | 管理员已登录，系统中存在 2001，不存在 9999                 | 响应`code≠1，msg`提示 “部分教师不存在” 或 “删除失败”；       | 验证包含无效 ID 时的删除处理 | 不通过，显示删除成功，但是存在的那个教师被删除成功了         |
| 4    | 删除的教师 ID 为空（如空路径）              | `/admin/teachers/`          | 管理员已登录                                               | 响应`code≠1，msg`提示 “教师 ID 不能为空”                     | 验证 ID 为空时的参数校验     | 不通过，{"code":0,"msg":"系统错误：No static resource admin/teachers.","data":null} |
| 5    | 教师 ID 格式错误（含非数字，如 2001,abc）   | `/admin/teachers/2001,abc`  | 管理员已登录                                               | 响应`code≠1，msg`提示 “教师 ID 格式错误”                     | 验证非数字 ID 的校验         | 不通过，{"code":0,"msg":"系统错误：For input string: \"aaa\"","data":null} |
| 6    | 删除已被关联的教师（如带课程 / 学生的教师） | `/admin/teachers/2004`      | 管理员已登录，教师 2004 存在且有课程任教或学生指导关联记录 | 响应`code≠1，msg`提示 “该教师存在关联数据，无法删除”；数据库记录未删除 | 验证存在关联数据时的删除限制 | 不通过，返回系统错误{"code":0,"msg":"系统错误：\r\n### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Cannot delete or update a parent row: a foreign key constraint fails (`campus_system`.`t_class`, CONSTRAINT `t_class_ibfk_2` FOREIGN KEY (`teacher_id`) REFERENCES `t_user` (`user_id`))\r\n### The error may exist in file [D:\\Item\\IDEA\\EduSphere-master\\target\\classes\\mapper\\UserMapper.xml]\r\n### The error may involve defaultParameterMap\r\n### The error occurred while setting parameters\r\n### SQL: DELETE FROM t_user WHERE user_id = ?\r\n### Cause: java.sql.SQLIntegrityConstraintViolationException: Cannot delete or update a parent row: a foreign key constraint fails (`campus_system`.`t_class`, CONSTRAINT `t_class_ibfk_2` FOREIGN KEY (`teacher_id`) REFERENCES `t_user` (`user_id`))\n; Cannot delete or update a parent row: a foreign key constraint fails (`campus_system`.`t_class`, CONSTRAINT `t_class_ibfk_2` FOREIGN KEY (`teacher_id`) REFERENCES `t_user` (`user_id`))","data":null} |